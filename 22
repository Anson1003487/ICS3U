# === Basic Data Configuration ===
month_map = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
             "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]

# === Global Data Storage ===
date_records = []  # Date code array
word_records = []  # Word data array

# === Data Loading ===
try:
    with open("wordle.dat", "r") as data_file:
        file_lines = data_file.readlines()
        
        # Parallel processing of data fields
        raw_dates = []
        raw_words = []
        for line in file_lines:
            columns = line.strip().split()
            if len(columns) == 4:
                raw_dates.append(columns[:3])
                raw_words.append(columns[3].upper())
        
        # Date conversion processing
        for date_parts, word in zip(raw_dates, raw_words):
            month_str = date_parts[0][:3].capitalize()
            day_str = date_parts[1].zfill(2)
            year_str = date_parts[2]
            
            # Month conversion
            month_num = 0
            for idx in range(12):
                if month_map[idx] == month_str:
                    month_num = idx + 1
                    break
            
            if month_num == 0:
                continue
            
            # Date validation
            try:
                date_value = int(f"{year_str}{month_num:02}{day_str}")
                if 20210619 <= date_value <= 20240421:
                    date_records.append(date_value)
                    word_records.append(word)
            except ValueError:
                pass
except FileNotFoundError:
    print("※ Error: Data file not found")
    exit()

# === User Interface ===
print(" Wordle Database Query System ")
running = True

while running:
    print("\nOperation Options:")
    print("[1] Search date by word")
    print("[2] Search word by date")
    print("[0] Exit system")
    
    choice = input("Please enter option number: ")
    
    # Option processing
    if choice == "0":
        running = False
        print("Thank you for using, goodbye!")
    
    elif choice == "1":
        search_word = input("Enter search word: ").strip().upper()
        found = False
        
        # Linear search
        for i in range(len(word_records)):
            if word_records[i] == search_word:
                print(f"Found record: Word 【{search_word}】 on date {date_records[i]}")
                found = True
                break
        if not found:
            print(f"Word not found: {search_word}")
    
    elif choice == "2":
        input_date = input("Enter date (YYYYMMDD): ").strip()
        
        # Input validation
        if not input_date.isdigit() or len(input_date) != 8:
            print("Error: Invalid date format")
            continue
        
        target_date = int(input_date)
        # Date range check
        if target_date < 20210619:
            print("Date is earlier than 2021-06-19, no records")
            continue
        if target_date > 20240421:
            print("Date is later than 2024-04-21, no records")
            continue
        
        # Array traversal
        match_found = False
        for j in range(len(date_records)):
            if date_records[j] == target_date:
                print(f"Found record: Date {target_date} corresponds to word 【{word_records[j]}】")
                match_found = True
                break
        if not match_found:
            print("No record for this date")
    
    else:
        print("Invalid option, please try again")

# === Program End ===
